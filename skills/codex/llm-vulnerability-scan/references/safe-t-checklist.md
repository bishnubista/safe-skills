# SAFE-T Primary Detection Checklist

> This checklist is the primary scan taxonomy. Findings should be keyed by `SAFE-T####`.
> OWASP LLM/Agentic categories and Agentic Controls are secondary rollups for reporting and parity.

## Primary/Secondary Model

- Primary taxonomy: `SAFE-T####` techniques (SAFE-MCP)
- Secondary taxonomy: `LLM##`, `ASI##`, `AC##`
- Report ordering: Severity first, technique-first within each severity

## Current Static-Code Coverage Set

This skill currently scans a static-code subset of SAFE-T techniques.

Covered techniques (44):

`SAFE-T1001, SAFE-T1002, SAFE-T1003, SAFE-T1004, SAFE-T1006, SAFE-T1008, SAFE-T1009,
SAFE-T1101, SAFE-T1102, SAFE-T1103, SAFE-T1104, SAFE-T1105, SAFE-T1106, SAFE-T1109,
SAFE-T1110, SAFE-T1111, SAFE-T1202, SAFE-T1204, SAFE-T1205, SAFE-T1206, SAFE-T1207,
SAFE-T1302, SAFE-T1303, SAFE-T1304, SAFE-T1305, SAFE-T1306, SAFE-T1308,
SAFE-T1401, SAFE-T1402, SAFE-T1403, SAFE-T1404,
SAFE-T1502, SAFE-T1503, SAFE-T1505,
SAFE-T1603,
SAFE-T1701, SAFE-T1702, SAFE-T1705,
SAFE-T1805,
SAFE-T1904,
SAFE-T2102, SAFE-T2105, SAFE-T2106, SAFE-T2107`

Mark uncovered SAFE-T techniques as `Not applicable (not in current static coverage set)` unless explicitly implemented.

## Severity Criteria

| Severity | Criteria |
|----------|----------|
| Critical | Direct code execution, prompt injection enabling control override, secret disclosure in prompts/context |
| High | Tool misuse paths, excessive permissions, unsafe output handling, supply-chain integrity gaps |
| Medium | Missing rate limits/timeout controls, weak isolation/segmentation, missing rollback protections |
| Low | Missing transparency and monitoring depth |
| Info | Defense-in-depth recommendations |

---

## Worker 1: Injection and Goal-Hijack Surfaces

**SAFE-T focus:** `SAFE-T1102`, `SAFE-T1110`, `SAFE-T1401`, `SAFE-T1402`, `SAFE-T1001`, `SAFE-T1008`  
**Secondary mapping:** `LLM01`, `LLM07`, `ASI01`, `AC02`

### Detection patterns

1. User or external content interpolated into system/instruction prompts without boundaries.
2. Prompt role merging (system + user in one content block).
3. Hidden instruction vectors from files, URLs, docs, or tool output.
4. Dynamic goal/instruction mutation from untrusted sources.

### Remediation baseline

- Use immutable instruction boundaries.
- Separate system/user/tool roles.
- Sanitize and bound untrusted content.
- Add injection screening before prompt assembly.

---

## Worker 2: Data Disclosure and Supply-Chain Surfaces

**SAFE-T focus:** `SAFE-T1502`, `SAFE-T1503`, `SAFE-T1505`, `SAFE-T1002`, `SAFE-T1003`, `SAFE-T1207`, `SAFE-T1004`, `SAFE-T1006`, `SAFE-T1009`, `SAFE-T1204`, `SAFE-T2107`  
**Secondary mapping:** `LLM02`, `LLM03`, `LLM04`, `ASI04`

### Detection patterns

1. Credentials, secrets, or sensitive env/material included in prompts or LLM context.
2. Unverified model/tool/dataset sources and missing integrity pinning.
3. Agent/MCP configs pointing to untrusted or unallowlisted servers.
4. Unvalidated ingestion into memory/RAG/training pipelines.

### Remediation baseline

- Strip credentials from LLM context.
- Pin versions and verify checksums/signatures.
- Enforce server allowlists and attestation where possible.
- Add provenance and validation gates on ingest paths.

---

## Worker 3: Output Handling, Tool Misuse, and Execution

**SAFE-T focus:** `SAFE-T1101`, `SAFE-T1105`, `SAFE-T1104`, `SAFE-T1106`, `SAFE-T1302`, `SAFE-T1103`, `SAFE-T1109`, `SAFE-T1205`, `SAFE-T1111`, `SAFE-T1303`, `SAFE-T1305`  
**Secondary mapping:** `LLM05`, `LLM06`, `ASI02`, `ASI05`, `AC01`, `AC03`, `AC04`

### Detection patterns

1. LLM output routed into `eval`, shell, SQL, file paths, or HTML sinks without validation.
2. Over-privileged tools with wildcard filesystem/network/exec scopes.
3. Tool calls accepted without strict schema validation.
4. Autonomous execution loops and generated code execution without sandbox constraints.

### Remediation baseline

- Validate/sanitize all tool I/O and model outputs.
- Replace wildcard permissions with allowlists.
- Require structured schemas for tool input/output.
- Enforce sandboxing and explicit approval for side effects.

---

## Worker 4: Identity, Privilege, Memory, and RAG

**SAFE-T focus:** `SAFE-T2106`, `SAFE-T1304`, `SAFE-T1306`, `SAFE-T1308`, `SAFE-T1202`, `SAFE-T1206`, `SAFE-T1702`  
**Secondary mapping:** `LLM08`, `ASI03`, `ASI06`

### Detection patterns

1. Vector/embedding stores without access controls or tenant isolation.
2. Long-lived/static credentials and broad credential inheritance.
3. Secrets in agent/MCP configs and persistent stores.
4. Memory/knowledge updates from untrusted sources without integrity controls.

### Remediation baseline

- Enforce vector-store auth and partitioning.
- Use short-lived scoped credentials.
- Move secrets to secret managers/env vaults.
- Add integrity/versioning for memory and knowledge updates.

---

## Worker 5: Reliability, Trust, and Inter-Agent Risk

**SAFE-T focus:** `SAFE-T2105`, `SAFE-T1404`, `SAFE-T2102`, `SAFE-T1701`, `SAFE-T1705`, `SAFE-T1904`  
**Secondary mapping:** `LLM09`, `LLM10`, `ASI07`, `ASI08`, `ASI09`, `ASI10`, `AC05`

### Detection patterns

1. Critical decisions from model output without verification or attribution.
2. Missing limits on calls/tokens/cost/retries/looping behavior.
3. Inter-agent messaging without source validation/signing.
4. Missing containment for cascading failure conditions.

### Remediation baseline

- Add verification and attribution for high-impact outputs.
- Apply rate limits, budgets, retry ceilings, and circuit breakers.
- Authenticate inter-agent messages and channels.
- Add safe-failure and rollback boundaries.

---

## Worker 6: Agentic Controls and Governance

**Primary focus:** `AC01`-`AC05` control outcomes  
**Technique linkage:** Use linked SAFE-T evidence above when reporting control gaps.

### Control checks

1. `AC01` Least-privilege tooling
2. `AC02` Input guardrails and context hygiene
3. `AC03` Tool I/O validation
4. `AC04` Human-in-the-loop approvals
5. `AC05` Observability and budget controls

### Remediation baseline

- Document evidence for each control as `Present`, `Partial`, or `Missing`.
- Tie each missing/partial control to concrete SAFE-T findings.
- Prioritize control fixes that reduce Critical/High technique exposure.

---

## Finding Format (Required)

````markdown
### [SAFE-T####] Technique Name - Brief description
- **File:** path/to/file:line_number
- **Severity:** Critical|High|Medium|Low|Info
- **Secondary:** LLM##, ASI##, AC##
- **Code:**
  ```text
  [3-5 relevant lines]
  ```
- **Issue:** Why this is dangerous
- **Remediation:** Specific fix
- **Mitigations:** SAFE-M-## (Mitigation Name)
````

If a technique has no findings, return exactly:

`No issues found for SAFE-T####`
