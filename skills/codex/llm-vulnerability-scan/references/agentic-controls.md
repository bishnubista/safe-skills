# Agentic Controls Checklist

This checklist covers cross-cutting controls that shape agentic behavior and reduce unsafe autonomy. Use alongside OWASP and SAFE-MCP checks.

## Severity Criteria

| Severity | Criteria |
|----------|----------|
| **High** | Over-privileged tools, missing approvals for destructive actions, missing schema validation on tool inputs |
| **Medium** | Missing audit logging, missing rate limits/budgets, missing circuit breakers or timeouts |
| **Low** | Partial coverage or documentation gaps |
| **Info** | Defense-in-depth recommendations |

---

## AC01 — Least-Privilege Tooling

**Mapped OWASP:** LLM06, ASI02
**SAFE-MCP Mitigations:** SAFE-M-14, SAFE-M-16, SAFE-M-29

**Detection Patterns:**

1. Tool definitions grant wildcard filesystem/network access (High)
2. No allowlist for tool scopes (paths, domains, APIs) (High)
3. Shared high-privilege tokens used across unrelated tools or agents (High)

**Remediation:** Narrow tool scopes, separate credentials per tool, and enforce allowlists.

---

## AC02 — Input Guardrails & Context Hygiene

**Mapped OWASP:** LLM01, LLM07, ASI01
**SAFE-MCP Mitigations:** SAFE-M-4, SAFE-M-5, SAFE-M-39

**Detection Patterns:**

1. No prompt-injection screening on user or external inputs (High)
2. System and user instructions merged without boundaries (High)
3. External data inserted into system prompts without sanitization (High)

**Remediation:** Enforce role separation, sanitize inputs, and bound external content.

---

## AC03 — Tool I/O Validation

**Mapped OWASP:** LLM05, LLM02, ASI02
**SAFE-MCP Mitigations:** SAFE-M-38, SAFE-M-21, SAFE-M-22, SAFE-M-5

**Detection Patterns:**

1. Tool calls accept unvalidated parameters (High)
2. LLM outputs used in downstream systems without validation or sanitization (High)
3. No output filters for secrets/PII before returning responses (High)

**Remediation:** Enforce strict schemas, validate outputs, and sanitize responses.

---

## AC04 — Human-in-the-Loop Approvals

**Mapped OWASP:** LLM06, ASI09
**SAFE-MCP Mitigations:** SAFE-M-11, SAFE-M-15

**Detection Patterns:**

1. Destructive or external side-effect actions run without confirmation (High)
2. No approval gates for sending, deleting, or executing operations (High)
3. Approvals exist but can be bypassed via automation (Medium)

**Remediation:** Require explicit approvals and enforce non-bypassable gates.

---

## AC05 — Observability & Budget Controls

**Mapped OWASP:** LLM10, ASI08, ASI10
**SAFE-MCP Mitigations:** SAFE-M-11, SAFE-M-12, SAFE-M-20, SAFE-M-23

**Detection Patterns:**

1. No audit logging for tool calls or agent actions (Medium)
2. Missing rate limits, token/cost caps, or circuit breakers (Medium)
3. Unbounded retries or loops without timeouts (Medium)

**Remediation:** Add audit logging, rate limits, budget caps, and circuit breakers.
